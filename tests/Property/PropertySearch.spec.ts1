import { test, expect  } from "@playwright/test";
import { PropertySearchResultPage } from "../../page-objects/Property/PropertySearchResultPage";
import { PropertyHomePage } from "../../page-objects/Property/PropertyHomePage";
import  MockRequest  from "../../page-objects/Common/MockRequest";

test.describe("Trademe Property:", () => { 
    let propetyHomePage,propetySearchResultPage,mockRequest: any;
    const PropertyMock = require("../../mock-request/Property/Property Property Residential For Sale Premium Mock data.mock.json");
        
    
    test.beforeEach(async ({ page, context }) => {
        propetySearchResultPage = new PropertySearchResultPage(page);
        propetyHomePage = new PropertyHomePage(page);
        mockRequest = new MockRequest(page);
        mockRequest.whenGet('v1\/search\/property\/residential.json?noAds=&category=3399&rows=', { body: PropertyMock });

    });
    
    test("Property Search Test", async ({ page, browserName, context }) => {
        await propetyHomePage.navigate('https://www.stage.trademe.co.nz/a/property/residential/');
        await propetyHomePage.clickSearch();

        expect(await propetySearchResultPage.getTmSearchHeaderHeading()).toContain('Houses and properties for sale');   

    });

});
